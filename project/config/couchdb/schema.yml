DR:
  definition:
    fields:
      _id: {}
      _rev: {}
      type: {}
      campagne: {  }
      updated: { required: false }
      validee: { required: false }
      modifiee: { required: false }
      utilisateurs:
        type: collection
        definition:
          fields:
            edition:
              type: collection
              definition:
                fields:
                  '*': {  }
            validation:
              type: collection
              definition:
                fields:
                  '*': {  }
      import_db2: {type: integer, required: false }
      declarant:
        type: collection
        class: DRDeclarant
        definition:
          fields:
            nom: {}
            email: {}
            telephone: {}
      acheteurs:
        type: collection
        class: DRAcheteurs
        definition:
          fields:
            '*':
              #------ Certification ------
              type: collection
              definition:
                fields:
                  '*':
                    #------ Genre ------
                    type: collection
                    definition:
                      fields:
                        '*':
                          # -------- rappel des appellations -------
                          type: collection
                          definition:
                            fields:
                              negoces:
                                type: array_collection
                                definition:
                                  fields:
                                    '*': {  }
                              cooperatives:
                                type: array_collection
                                definition:
                                  fields:
                                    '*': {  }
                              cave_particuliere: {type: integer}
                              mouts:
                                type: array_collection
                                definition:
                                  fields:
                                    '*': {  }
      cvi: {  }
      lies: {type: float}
      jeunes_vignes: {type: float}
      declaration_commune: {}
      declaration_insee: {}
      etape: {type: string, required: false}
      recolte:
        type: collection
        class: DRRecolte
        definition:
          fields:
            '*':
              #------ Certification ------
              type: collection
              class: DRRecolteCertification
              definition:
                fields:
                  total_volume: {type: float}
                  total_superficie: {type: float}
                  volume_revendique: {type:float }
                  dplc: {type:float }
                  usages_industriels_calcule: {type:float }
                  '*':
                  #------ Genre ------
                    type: collection
                    class: DRRecolteGenre
                    definition:
                      fields:
                        total_volume: {type: float}
                        total_superficie: {type: float}
                        volume_revendique: {type:float }
                        dplc: {type:float }
                        usages_industriels_calcule: {type:float }
                        '*':
                          # ------ Appellation ------
                          type: collection
                          class: DRRecolteAppellation
                          definition:
                            fields:
                              appellation: {}
                              total_volume: {type: float}
                              total_superficie: {type: float}
                              volume_revendique: {type:float }
                              dplc: {type:float }
                              usages_industriels_calcule: {type:float }
                              # ------- MENTION ----------
                              'mention':
                                type : collection
                                class: DRRecolteMention
                                definition:
                                  fields:
                                    total_volume: {type: float }
                                    total_superficie: {type:float }
                                    volume_revendique: {type:float }
                                    dplc: {type:float }
                                    usages_industriels_calcule: {type:float }
                                    # ------- LIEU ----------
                                    '*':
                                      type: collection
                                      class: DRRecolteLieu
                                      definition:
                                        fields:
                                          total_volume: {type:float}
                                          total_superficie: {type:float}
                                          volume_revendique: {type: float}
                                          dplc: {type: float}
                                          usages_industriels_calcule: {type:float }
                                          usages_industriels_saisi: {type:float }
                                          acheteurs:
                                             type: collection
                                             definition:
                                               fields:
                                                 negoces:
                                                   type: collection
                                                   definition:
                                                     fields:
                                                       '*':
                                                         type: collection
                                                         class: DRRecolteLieuAcheteur
                                                         definition:
                                                           fields:
                                                             type_acheteur: {}
                                                             nom: {}
                                                             commune: {}
                                                             superficie: {type:float}
                                                             dontdplc: {type:float}
                                                 cooperatives:
                                                   type: collection
                                                   definition:
                                                     fields:
                                                       '*':
                                                         type: collection
                                                         class: DRRecolteLieuAcheteur
                                                         definition:
                                                           fields:
                                                             type_acheteur: {}
                                                             nom: {}
                                                             commune: {}
                                                             superficie: {type:float}
                                                             dontdplc: {type:float}
                                                 mouts:
                                                   type: collection
                                                   definition:
                                                     fields:
                                                       '*':
                                                         type: collection
                                                         class: DRRecolteLieuAcheteur
                                                         definition:
                                                           fields:
                                                             type_acheteur: {}
                                                             nom: {}
                                                             commune: {}
                                                             superficie: {type:float}
                                                             dontdplc: {type:float}
                                          # ------ Couleur ------
                                          '*':
                                            type: collection
                                            class: DRRecolteCouleur
                                            definition:
                                              fields:
                                                total_volume: {type:float}
                                                total_superficie: {type:float}
                                                volume_revendique: {type: float}
                                                dplc: {type: float}
                                              # ------ CÃ©page ------
                                                '*':
                                                  type: collection
                                                  class: DRRecolteCepage
                                                  definition:
                                                    fields:
                                                      total_volume: {type: float }
                                                      total_superficie: {type:float }
                                                      volume_revendique: {type:float }
                                                      dplc: {type:float }
                                                      detail:
                                                        type: array_collection
                                                        definition:
                                                          fields:
                                                            '*':
                                                              type: collection
                                                              class: DRRecolteCepageDetail
                                                              definition:
                                                                fields:
                                                                  appellation: {  }
                                                                  cepage: {  }
                                                                  lieu: {  }
                                                                  denomination: {  }
                                                                  vtsgn: {  }
                                                                  code_lieu: {  }
                                                                  volume: { type: float }
                                                                  superficie: { type: float }
                                                                  motif_non_recolte: { required: false }
                                                                  negoces:
                                                                    type: array_collection
                                                                    definition:
                                                                      fields:
                                                                        '*':
                                                                          type: collection
                                                                          definition:
                                                                            fields:
                                                                              cvi: {  }
                                                                              quantite_vendue: { type: float }
                                                                  cooperatives:
                                                                    type: array_collection
                                                                    definition:
                                                                      fields:
                                                                        '*':
                                                                          type: collection
                                                                          definition:
                                                                            fields:
                                                                              cvi: {  }
                                                                              quantite_vendue: { type: float }
                                                                  mouts:
                                                                    type: array_collection
                                                                    required: false
                                                                    definition:
                                                                      fields:
                                                                        '*':
                                                                          type: collection
                                                                          definition:
                                                                            fields:
                                                                              cvi: {  }
                                                                              quantite_vendue: { type: float }
                                                                  cave_particuliere: { type: float }
                                                                  volume_revendique: { type: float }
                                                                  volume_dplc: { type: float }

Acheteur:
  inheritance: _Tiers
  definition:
    fields:
      _id: {  }
      _rev: {  }
      cvi: {  }
      civaba: {  }
      type: {  }
      qualite: {  }
      nom: {  }
      commune: {  }
      achnum: { required: false }

_Compte:
  type: abstract
  definition:
    fields:
      login: { }
      mot_de_passe: {  }
      email: {  }
      statut: {  }
      droits:
        type: array_collection
        definition:
          fields:
            '*': { }

CompteProxy:
  inheritance: _Compte
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      compte_reference: {  }

CompteTiers:
  inheritance: _Compte
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      db2:
        type: collection
        definition:
          fields:
            no_stock: { }
      tiers:
        type: collection
        definition:
          fields:
            '*':
              type: collection
              definition:
                fields:
                  id: {  }
                  type: {  }
                  nom: {  }
      delegation:
              type: collection
              definition:
                fields:
                  '*': {  }

CompteVirtuel:
  inheritance: _Compte
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      nom: {  }
      commune: {  }
      code_postal: {  }

_Tiers:
  type: abstract
  definition:
    fields:
      compte:
        type: array_collection
        definition:
          fields:
            '*': {  }
      civaba: {  }
      intitule: {  }
      nom: {  }
      telephone: {  }
      fax: {  }
      email: {  }
      web: {  }
      exploitant:
        class: _TiersExploitant
        type: collection
        required: false
        definition:
          fields:
            sexe: {  }
            nom: {  }
            adresse: {  }
            code_postal: {  }
            commune: {  }
            date_naissance: {  }
            telephone: {  }
      siege:
        class: _TiersSiege
        type: collection
        definition:
          fields:
            adresse: {  }
            insee_commune: {  }
            code_postal: { }
            commune: {  }
      categorie: { }
      db2:
        type: collection
        definition:
          fields:
            num: { }
            no_stock: { }
            import_date: {  }
            export_revision: {  }

Recoltant:
  inheritance: _Tiers
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      cvi: {  }
      declaration_insee: {  }
      declaration_commune: {  }
      siret: {  }
      cave_cooperative: {  }

MetteurEnMarche:
  inheritance: _Tiers
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      cvi_acheteur: {  }
      no_accises: {  }
      gamma:
        required: false
        type: collection
        definition:
          fields:
            statut: {  }
            num_cotisant: {  }
      siren: {  }
      db2:
        type: collection
        definition:
          fields:
            maison_mere: {  }
Current:
  definition:
    fields:
      _id: {}
      _rev: {}
      type: {}
      campagne: {}
      dr_non_editable: {}
      dr_non_ouverte: {}

Configuration:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {}
      campagne: {}
      virtual : {required: false}
      dr_non_editable: {required: false}
      intitule:
        type: array_collection
        definition:
          fields:
            '*': {  }
      motif_non_recolte:
        type: collection
        definition:
          fields:
            '*': {  }
      recolte:
        type: collection
        class: ConfigurationRecolte
        definition:
          fields:
            no_usages_industriels: { required: false}
            douane :
              type: collection
              class: ConfigurationDouane
              definition:
                fields:
                  type_aoc: {required: false}
                  couleur: {required: false}
                  appellation_lieu: {required: false}
                  qualite: {required: false}
                  qualite_vt: {required: false}
                  qualite_sgn: {required: false}
                  qualite_aoc: {required: false}
                  code_cepage: {required: false}
            '*':
              # ------- Certification ---------
              type: collection
              class: ConfigurationCertification
              definition:
                fields:
                  rendement: { type: float }
                  libelle: { }
                  douane:
                    type: collection
                    class: ConfigurationDouane
                    definition:
                      fields:
                        '*': {  }
                  '*':
                  # ------- Genre ---------
                    type: collection
                    class: ConfigurationGenre
                    definition:
                      fields:
                        rendement: { type: float }
                        libelle: { }
                        douane:
                          type: collection
                          class: ConfigurationDouane
                          definition:
                            fields:
                              '*': {  }
                        '*':
                        # ------- APPELLATION ---------
                          type: collection
                          class: ConfigurationAppellation
                          definition:
                            fields:
                              appellation: { }
                              libelle: {  }
                              rendement : { type: float }
                              rendement_appellation: { type: float }
                              mout: {type: integer}
                              no_total_cepage: {type: integer, required: false}
                              detail_lieu_editable: {type: integer, required: false}
                              exclude_total: {type: integer, required: false}
                              no_vtsgn: {required: false}
                              douane :
                                type: collection
                                class: ConfigurationDouane
                                definition:
                                  fields:
                                    type_aoc: {required: false}
                                    couleur: {required: false}
                                    appellation_lieu: {required: false}
                                    qualite: {required: false}
                                    qualite_aoc: {required: false}
                                    code_cepage: {required: false}
                              # ------- MENTION ----------
                              '*':
                                type : collection
                                class: ConfigurationMention
                                definition:
                                  fields:
                                    libelle: {  }
                                    rendement: { type: float  }
                                    rendement_mention: { type: float  }
                                    douane :
                                      type: collection
                                      class: ConfigurationDouane
                                      definition:
                                        fields:
                                          '*': {  }
                                    '*':
                                    # ------------ LIEU --------------
                                      type: collection
                                      class: ConfigurationLieu
                                      definition:
                                        fields:
                                          rendement: {type: float}
                                          rendement_mention: { type: float  }
                                          rendement_appellation: { type: float }
                                          libelle: { }
                                          douane :
                                            type: collection
                                            class: ConfigurationDouane
                                            definition:
                                              fields:
                                                type_aoc: {required: false}
                                                couleur: {required: false}
                                                appellation_lieu: {required: false}
                                                qualite: {required: false}
                                                code_cepage: {required: false}
                                          # ------------ COULEUR --------------
                                          '*' :
                                            type: collection
                                            class: ConfigurationCouleur
                                            definition:
                                              fields:
                                                rendement_couleur: { type: float }
                                                rendement: { type: float }
                                                libelle: { }
                                                douane :
                                                  type: collection
                                                  class: ConfigurationDouane
                                                  definition:
                                                    fields:
                                                      type_aoc: {required: false}
                                                      couleur: {required: false}
                                                      appellation_lieu: {required: false}
                                                      qualite: {required: false}
                                                      code_cepage: {required: false}
                                                '*':
                                                # ------------ CEPAGE -------------
                                                  type: collection
                                                  class: ConfigurationCepage
                                                  definition:
                                                    fields:
                                                      no_vtsgn: {required: false}
                                                      douane :
                                                        type: collection
                                                        class: ConfigurationDouane
                                                        definition:
                                                          fields:
                                                            type_aoc: {required: false}
                                                            couleur: {required: false}
                                                            appellation_lieu: {required: false}
                                                            qualite: {required: false}
                                                            code_cepage: {required: false}
                                                      libelle: {  }
                                                      rendement: { type: float }
                                                      min_quantite: {type: float, required: false}
                                                      max_quantite: {type: float, required: false}
                                                      exclude_total: {type: integer, required: false}
                                                      superficie_optionnelle: { type: integer, required: false }
                                                      no_negociant : { type: integer, required: false }
                                                      no_cooperative : { type: integer, required: false }
                                                      no_mout : { type: integer, required: false }
                                                      no_motif_non_recolte : { type: integer, required: false }

CSV:
  definition:
    fields:
      _id: {}
      _rev: {}
      type: {}
      campagne: {}
      cvi: {}
      recoltants : 
        type: array_collection
        definition:
          fields:
            '*': { }

Messages:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {}
      '*': {}

Export:
  definition:
    fields:
      _id: {  }
      _rev: {  }
      type: {  }
      destinataire: {  }
      identifiant: {  }
      compte: {  }
      cle: {  }
      nom: {  }
      drs:
        type: collection
        definition:
          fields:
            ids:
              type: array_collection
              definition:
                fields:
                  '*': {  }
            views:
              type: array_collection
              definition:
                fields:
                  '*':
                    type: collection
                    definition:
                      fields:
                        id: {  }
                        nom: {  }
                        startkey:
                          type: array_collection
                          definition:
                            fields:
                              '*' : {  }
                        endkey:
                          type: array_collection
                          definition:
                            fields:
                              '*' : {  }
LS:
  definition:
    fields:
      _id: { }
      _rev: { }
      type: { }
      pointeur: { }


