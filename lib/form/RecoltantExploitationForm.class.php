<?php

class RecoltantExploitationForm extends sfCouchdbFormDocumentJson {

    public function configure() {
        $this->setWidgets(array(
				'siret' => new sfWidgetFormInputText(array('label' => "N° de SIRET")),
				'intitule' => new sfWidgetFormInputText(array('label' => "Intitulé de l'exploitation")),
				'nom' => new sfWidgetFormInputText(array('label' => "Nom de l'exploitation")),
				'telephone' => new sfWidgetFormInputText(array('label' => 'Téléphone')),
				'fax' => new sfWidgetFormInputText(array('label' => 'Fax')),
				/*
				'code_postal' => new sfWidgetFormInputText(array('label' => 'Code Postal')),
				'adresse' => new sfWidgetFormTextarea(array('label' => 'Adresse')),
				'commune' => new sfWidgetFormInputText(array('label' => 'Commune')),
				*/
				));
	
        $this->setValidators(array(
				   /*
				   'code_postal' => new sfValidatorNumber(array('required' => true), array('invalid' => 'Ne doit contenir que des chiffres', 'required' => 'Champ Requis')),
				   'adresse' => new sfValidatorString(array('required' => true), array('required' => 'Champ Requis')),
				   'commune' => new sfValidatorString(array('required' => true), array( 'required' => 'Champ Requis')),
				   */
				   'nom' => new sfValidatorString(array('required' => true), array('required' => 'Champ Requis')),
				   'siret' => new sfValidatorNumber(array('required' => true), array('invalid' => 'Ne doit contenir que des chiffres', 'required' => 'Champ Requis')),
				   'telephone' => new sfValidatorString(array('required' => false, 'max_length' => 10, 'min_length' => 10), array('invalid' => 'Ne doit contenir que des chiffres')),
				   'fax' => new sfValidatorString(array('required' => false, 'max_length' => 10, 'min_length' => 10), array('invalid' => 'Ne doit contenir que des chiffres')),
				   ));
        //$this->validatorSchema->setPostValidator();

	$this->siege = new RecoltantSiegeForm($this->getObject()->getSiege());
	$this->embedForm('siege', $this->siege);

        $this->widgetSchema->setNameFormat('exploitatation[%s]');
        $this->errorSchema = new sfValidatorErrorSchema($this->validatorSchema);
    }

}